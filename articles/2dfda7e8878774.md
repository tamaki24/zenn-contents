---
title: "Denoã§ã‚µãƒƒã¨Preactã‚’æ›¸ã"
emoji: "ğŸ¦•"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["zennfes2025free", "deno", "preact", "typescript"]
published: true
---

âš ï¸ **æ³¨æ„** `deno bundle`ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€Deno2.4.0ä»¥é™ãŒå¿…è¦ã§ã™ã€‚
[Deno - Bundling](https://docs.deno.com/runtime/reference/bundling/)

# Preact + Deno
Denoç’°å¢ƒã§`deno bundle`ã‚³ãƒãƒ³ãƒ‰ã‚’æ´»ç”¨ã—ã€ã‚·ãƒ³ãƒ—ãƒ«ã«Preactã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§å‹•ã‹ã—ã¾ã™ã€‚
ä»¥ä¸‹ã®æ‰‹é †ã¯ã€Deno 2.5.1 ã®ç’°å¢ƒã§å®Ÿè¡Œã—ã¦ä½œæˆã—ã¦ã„ã¾ã™ã€‚

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
ã¾ãšã¯Denoã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€åˆæœŸåŒ–ã—ã¾ã™ã€‚

```bash
mkdir preact-deno
cd preact-deno

deno init
```

## 2. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ
`deno.json`ã«ã€Preactã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆè¨­å®šã¨ã€é–‹ç™ºã«å¿…è¦ãªã‚¿ã‚¹ã‚¯ã‚’è¿½åŠ ã—ã¾ã™ã€‚
ã¾ãšã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã„ãã¾ã™ã€‚

```bash
deno add npm:preact npm:preact/hooks
```

å®Ÿè¡Œã™ã‚‹ã¨ã€`deno.json`ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•çš„ã«æ›´æ–°ã•ã‚Œã€`preact`ã¨`preact/hooks`ãŒ importsã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚
[Deno - add](https://docs.deno.com/runtime/reference/cli/add/)

æ¬¡ã«ã€`deno.json`ã«`compilerOptions`ã¨ã€é–‹ç™ºãƒ»ãƒ“ãƒ«ãƒ‰ç”¨ã®`tasks`ã‚’è¿½åŠ ã—ã¾ã™ã€‚å®Œæˆã—ãŸ`deno.json`ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```json
{
  "imports": {
    "preact": "npm:preact@10.20.2",
    "preact/hooks": "npm:preact@10.20.2/hooks"
  },
  "tasks": {
    "dev": "deno run --allow-net --allow-read https://deno.land/std@0.218.2/http/file_server.ts",
    "bundle": "deno bundle -o dist/bundle.js main.tsx"
  },
  "compilerOptions": {
    "jsx": "react-jsx",
    "jsxImportSource": "preact"
  }
}
```

* compilerOptions: Denoã«JSXã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹æ–¹æ³•ã‚’ä¼ãˆã¾ã™ã€‚
* tasks: devã¨bundleã¨ã„ã†2ã¤ã®ã‚¿ã‚¹ã‚¯ã‚’å®šç¾©ã—ã¾ã—ãŸã€‚`deno task dev`ã§é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã€`deno task bundle`ã§JSXæ§‹æ–‡ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ãŒè§£é‡ˆã§ãã‚‹JavaScriptã‚³ãƒ¼ãƒ‰ã«å¤‰æ›ã—ã¦ã€`bundle.js`ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

## 3. Preactã§main.tsxã‚’ä½œæˆ
ä»¥ä¸‹ã®å†…å®¹ã§`main.tsx`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```ts
import { render } from "preact";
import { useState } from "preact/hooks";

function App() {
  const [count, setCount] = useState(0);
  return (
    <div>
      <h1>Hello from Preact + Deno</h1>
      <button onClick={() => setCount(count + 1)}>Count: {count}</button>
    </div>
  );
}

render(<App />, document.getElementById("app")!);
```
* renderé–¢æ•°ã§ç”»é¢ã«è¡¨ç¤ºã—ãŸã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å…ˆã®HTMLè¦ç´ ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚
* æœ«å°¾ã®`!`ã¯ã€TypeScriptã«ãŠã„ã¦ã€Œã“ã®è¦ç´ ã¯å¿…ãšå­˜åœ¨ã—ã¾ã™ã€ã¨ã„ã†ã“ã¨ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ä¼ãˆã‚‹énullã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³æ¼”ç®—å­ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€è¦ç´ ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã“ã¨ã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ã‚’é˜²ã„ã§ã„ã¾ã™ã€‚

## 4. index.htmlã®ä½œæˆ
`index.html`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€ãƒãƒ³ãƒ‰ãƒ«ã•ã‚ŒãŸJavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚

```html
<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8"/>
    <title>Preact + Deno</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="./dist/bundle.js"></script>
  </body>
</html>
```

## 5. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒãƒ³ãƒ‰ãƒ«
`deno task bundle`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€`main.tsx`ã‚’JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒãƒ³ãƒ‰ãƒ«ã—ã¾ã™ã€‚

```bash
deno task bundle
```

ã“ã‚Œã«ã‚ˆã‚Šã€distãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒä½œæˆã•ã‚Œã€`main.tsx`ãŒãƒãƒ³ãƒ‰ãƒ«ãƒ»ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã•ã‚Œã¦`dist/bundle.js`ã¨ã—ã¦å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

## 6. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•
`deno task`ã‚³ãƒãƒ³ãƒ‰ã§é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã¾ã™ã€‚

```bash
deno task dev

# å‡ºåŠ›ä¾‹ï¼š
Task dev deno run --allow-net --allow-read https://deno.land/std@0.218.2/http/file_server.ts
Listening on http://0.0.0.0:4507/ (http://localhost:4507/)
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯`deno.json`ã«å®šç¾©ã•ã‚ŒãŸdevã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
ãƒ–ãƒ©ã‚¦ã‚¶ã§`http://localhost::4507/`ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€å‹•ä½œã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

## 7.ã“ã“ã¾ã§ã®ã‚³ãƒ¼ãƒ‰

https://github.com/tamaki24/preact-deno

